# Xray 节点配置 - 快速演示

## 功能演示

### 🎯 场景 1：添加 VLESS + TLS Inbound

**步骤**：

1. **访问节点管理页面**
   - 打开 http://localhost:3000/nodes
   - 页面显示所有 Slave 节点

2. **选择目标 Slave**
   - 点击顶部 Slave 选择器
   - 选择 "node-01"（或任意在线节点）

3. **点击 "添加 Inbound" 按钮**
   - 弹出配置表单

4. **选择协议**
   - 点击 "VLESS" 按钮（默认已选中）

5. **填写基础配置**
   ```
   标签 (Tag): vless-443
   监听端口: 443
   监听地址: 0.0.0.0（默认）
   ```

6. **生成 UUID**
   - 在 UUID 字段右侧点击 🔄 按钮
   - 自动生成：`a1b2c3d4-e5f6-4abc-8def-123456789abc`

7. **配置流控**
   - 流控 (Flow): 选择 "xtls-rprx-vision"（推荐）

8. **配置传输**
   - 传输协议: TCP（默认）
   - 传输层安全: TLS

9. **配置 TLS**
   ```
   SNI (ServerName): example.com
   证书文件路径: /etc/xray/cert.crt
   密钥文件路径: /etc/xray/key.key
   ```

10. **配置流量嗅探**
    - 启用流量嗅探: ✓ 已启用
    - 嗅探类型: ✓ HTTP ✓ TLS

11. **预览配置**（可选）
    - 点击 "预览配置" 按钮
    - 查看生成的完整 JSON

12. **保存并推送**
    - 点击 "保存并推送" 按钮
    - 配置自动推送到 node-01
    - Slave 自动重载 Xray

13. **查看结果**
    - 列表中出现新 Inbound
    - Tag: `vless-443`
    - 协议: VLESS
    - 端口: 443
    - 状态: 运行中

---

### 🎯 场景 2：添加 Shadowsocks Inbound

**步骤**：

1. **点击 "添加 Inbound"**

2. **选择协议**
   - 点击 "Shadowsocks" 按钮

3. **填写配置**
   ```
   标签 (Tag): ss-9000
   监听端口: 9000
   ```

4. **选择加密方式**
   - 加密方式: aes-256-gcm（推荐）

5. **生成密码**
   - 点击密码字段右侧的 🔄 按钮
   - 自动生成 32 位强密码

6. **选择网络协议**
   - 网络协议: TCP + UDP

7. **保存并推送**
   - 配置立即生效

---

### 🎯 场景 3：编辑现有 Inbound

**步骤**：

1. **找到要编辑的 Inbound**
   - 例如：`vless-443`

2. **点击 ✏️ 编辑按钮**
   - 表单自动填充现有配置
   - 协议类型不可更改（灰色）

3. **修改端口**
   ```
   监听端口: 443 → 8443
   ```

4. **修改 Tag**
   ```
   标签: vless-443 → vless-8443
   ```

5. **保存**
   - 配置更新并推送
   - Xray 自动重载

---

### 🎯 场景 4：使用协议筛选

**步骤**：

1. **查看所有 Inbound**
   - 列表显示：VLESS (1)、VMess (2)、Shadowsocks (5)

2. **筛选 VLESS**
   - 协议筛选下拉框选择 "VLESS (1)"
   - 只显示 VLESS 类型的 Inbound

3. **复制 Tag**
   - 点击 Tag 右侧的 📋 复制按钮
   - Tag 已复制到剪贴板
   - 图标变为 ✓（2秒后恢复）

---

### 🎯 场景 5：查看配置详情

**步骤**：

1. **点击 👁️ 查看图标**
   - 弹出配置预览窗口

2. **查看完整 JSON**
   ```json
   {
     "tag": "vless-443",
     "port": 443,
     "protocol": "vless",
     "settings": {
       "clients": [{
         "id": "uuid-here",
         "flow": "xtls-rprx-vision"
       }]
     },
     ...
   }
   ```

3. **关闭预览**
   - 点击右上角 ❌ 或遮罩层

---

## 字段详解

### VLESS 协议字段

| 字段 | 说明 | 示例 |
|------|------|------|
| Tag | 唯一标识符 | `vless-in` |
| 端口 | 监听端口 | `443` |
| UUID | 客户端身份 | `a1b2c3d4-e5f6-4abc-...` |
| 流控 | 流控类型 | `xtls-rprx-vision` |
| 传输协议 | 网络传输 | TCP/WebSocket/gRPC |
| 传输层安全 | 加密方式 | TLS/Reality |
| SNI | TLS 域名 | `example.com` |
| 证书路径 | TLS 证书 | `/etc/xray/cert.crt` |
| 密钥路径 | TLS 密钥 | `/etc/xray/key.key` |

### VMess 协议字段

| 字段 | 说明 | 示例 |
|------|------|------|
| Tag | 唯一标识符 | `vmess-8443` |
| 端口 | 监听端口 | `8443` |
| UUID | 客户端身份 | `b2c3d4e5-f6a7-...` |
| AlterID | 额外 ID | `0`（推荐） |
| 加密方式 | 加密算法 | `auto` |
| 传输协议 | 网络传输 | TCP/WebSocket |

### Shadowsocks 协议字段

| 字段 | 说明 | 示例 |
|------|------|------|
| Tag | 唯一标识符 | `ss-9000` |
| 端口 | 监听端口 | `9000` |
| 加密方式 | 加密算法 | `aes-256-gcm` |
| 密码 | 连接密码 | `strongPassword123!` |
| 网络协议 | 支持协议 | TCP + UDP |

---

## 协议选择建议

### 🔐 高安全场景
**推荐**：VLESS + TLS + Vision
- 最新协议
- 内置流控
- 抗检测能力强

### ⚡ 高性能场景
**推荐**：Shadowsocks 2022
- 加密方式：`2022-blake3-aes-256-gcm`
- 性能优秀
- 配置简单

### 🌐 Web 伪装场景
**推荐**：VLESS/VMess + WebSocket + TLS
- WebSocket 路径：`/ws`
- 可配合 CDN
- 流量特征类似 HTTPS

### 🛡️ 防御 DPI 场景
**推荐**：VLESS + Reality
- 无需证书
- 伪装真实网站
- 极强抗检测

---

## 常见配置示例

### 1. 标准 VLESS + TLS
```
协议: VLESS
端口: 443
流控: xtls-rprx-vision
传输: TCP
安全: TLS
证书: /etc/xray/cert.crt
```

### 2. WebSocket 伪装
```
协议: VLESS
端口: 443
传输: WebSocket
WS 路径: /ws
安全: TLS
SNI: example.com
```

### 3. Shadowsocks 2022
```
协议: Shadowsocks
端口: 9000
加密: 2022-blake3-aes-256-gcm
密码: [自动生成]
网络: TCP + UDP
```

### 4. SOCKS5 代理
```
协议: SOCKS
端口: 1080
认证: 无需认证
UDP: 启用
```

---

## 快捷操作

| 操作 | 快捷方式 |
|------|----------|
| 生成 UUID | 点击 🔄 按钮 |
| 生成密码 | 点击 🔄 按钮 |
| 预览配置 | 表单底部 "预览配置" |
| 复制 Tag | 列表中点击 📋 |
| 查看详情 | 列表中点击 👁️ |
| 编辑配置 | 列表中点击 ✏️ |
| 删除配置 | 列表中点击 🗑️ |

---

## 注意事项

### ⚠️ 端口占用
- 确保端口未被占用
- 同一 Slave 不能有重复端口
- 系统端口（1-1024）需要 root 权限

### ⚠️ Tag 唯一性
- 同一 Slave 的 Tag 必须唯一
- 建议命名规则：`协议-端口`
- 例如：`vless-443`, `ss-9000`

### ⚠️ TLS 证书
- 证书必须在 Slave 服务器上存在
- 路径必须可读
- 推荐使用 Let's Encrypt

### ⚠️ 配置推送
- 推送后 Xray 自动重载
- 短暂中断连接（< 1 秒）
- 建议在低峰期操作

---

## 故障排查

### 问题 1: UUID 格式错误
**症状**：保存时提示 "UUID 格式不正确"

**解决**：
1. 使用内置生成器
2. 检查格式：`xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx`
3. 确保小写字母

### 问题 2: 端口验证失败
**症状**：保存时提示 "端口不能小于 1"

**解决**：
1. 端口范围：1-65535
2. 避免使用已占用端口
3. 检查是否为纯数字

### 问题 3: 配置推送失败
**症状**：保存后列表未更新

**解决**：
1. 确认 Slave 在线（绿色状态）
2. 检查网络连接
3. 查看浏览器控制台错误
4. 手动刷新列表

### 问题 4: 字段未显示
**症状**：某些字段看不见

**原因**：条件渲染

**解决**：
1. VLESS TLS 字段需要 "传输层安全" 设置为 TLS
2. WebSocket 字段需要 "传输协议" 设置为 WebSocket
3. 检查父字段配置

---

## 最佳实践

### ✅ DO
- 使用内置生成器创建 UUID 和密码
- 为每个 Inbound 设置描述性 Tag
- 定期备份配置
- 使用最新加密算法
- 启用流量嗅探

### ❌ DON'T
- 不要手动输入 UUID（容易出错）
- 不要使用弱密码
- 不要在生产环境直接修改
- 不要忘记配置 TLS 证书
- 不要在高峰期推送配置

---

**提示**：所有操作都会实时同步到 Slave 服务器，无需手动重启。
